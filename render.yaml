services:
  # Service untuk Database PostgreSQL
  - type: pserv
    name: edumap-db
    runtime: image
    image:
      url: postgres:15
    plan: free # Data akan hilang saat restart, cukup untuk development/UAS

  # Service untuk Aplikasi Web Laravel
  - type: web
    name: edumap-app
    runtime: docker
    dockerfilePath: ./Dockerfile.render
    plan: free
    healthCheckPath: /
    # Penting: Render secara otomatis mengatur APP_URL, jadi kita tidak perlu menentukannya
    envVars:
      - key: APP_KEY
        generateValue: true
      - key: APP_ENV
        value: production
      - key: DB_CONNECTION
        value: pgsql
      - key: DATABASE_URL # Laravel akan otomatis menggunakan ini
        fromDatabase:
          name: edumap-db
          property: connectionString
    autoDeploy: true